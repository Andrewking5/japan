<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>日本關西之旅 - 智能行程規劃</title>
    <link rel="stylesheet" href="styles_detailed.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* 額外的增強樣式 */
        .search-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: transform 0.3s ease;
        }
        
        .search-btn:hover {
            transform: translateY(-2px);
        }
        
        .detail-btn {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            color: #667eea;
            padding: 5px 8px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }
        
        .detail-btn:hover {
            background: #667eea;
            color: white;
            transform: scale(1.1);
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 0;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.3s ease;
        }
        
        .modal-header {
            padding: 20px 30px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h2 {
            color: #333;
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        
        .close:hover {
            color: #667eea;
        }
        
        .modal-body {
            padding: 30px;
        }
        
        .search-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .search-container input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s ease;
        }
        
        .search-container input:focus {
            border-color: #667eea;
        }
        
        .search-container button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: transform 0.3s ease;
        }
        
        .search-container button:hover {
            transform: translateY(-2px);
        }
        
        .search-result-item {
            padding: 15px;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .search-result-item:hover {
            background: #f8f9fa;
            border-color: #667eea;
            transform: translateX(5px);
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .nav-actions {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .hero-actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 40px;
        }
        
        .btn-primary, .btn-secondary {
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .btn-primary:hover, .btn-secondary:hover {
            transform: translateY(-3px);
        }

        /* 預約比價：左右滑動走馬燈 */
        .booking-list {
            display: flex;
            gap: 16px;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            padding: 8px 2px 12px;
        }
        .booking-list::-webkit-scrollbar { display: none; }
        .booking-card {
            flex: 0 0 85%;
            max-width: 85%;
            scroll-snap-align: start;
        }
        @media (min-width: 768px) {
            .booking-card { flex-basis: 60%; max-width: 60%; }
        }
        @media (min-width: 1024px) {
            .booking-card { flex-basis: 45%; max-width: 45%; }
        }
        .booking-carousel-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: flex-end;
            margin: 8px 0 12px;
        }
        .booking-carousel-controls .carousel-btn {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            color: #667eea;
            padding: 10px 12px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .booking-carousel-controls .carousel-btn:hover {
            background: #667eea;
            color: #fff;
        }

        /* Booking card visual polish */
        .booking-card {
            background: #ffffff;
            border: 1px solid #eef0f3;
            border-radius: 14px;
            padding: 16px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.06);
        }
        .booking-card h3 { display: flex; align-items: center; justify-content: space-between; gap: 8px; }
        .best-badge {
            display: inline-block;
            background: #e8f5e9;
            color: #2e7d32;
            border-radius: 999px;
            padding: 4px 10px;
            font-size: 12px;
            font-weight: 700;
        }
        .provider-row { display: grid; grid-template-columns: 1fr auto auto; align-items: center; gap: 10px; padding: 8px 0; }
        .provider-row + .provider-row { border-top: 1px dashed #eef0f3; }
        .price-field { width: 130px; border: 1px solid #e9ecef; border-radius: 10px; padding: 8px 10px; }
        .open-link { background: #f8f9fa; border: 1px solid #e9ecef; color: #667eea; border-radius: 10px; padding: 8px 10px; cursor: pointer; }
        .open-link:hover { background: #667eea; color: #fff; }

        /* Toast */
        .toast-container { position: fixed; right: 16px; bottom: 16px; z-index: 3000; display: flex; flex-direction: column; gap: 8px; }
        .toast { background: rgba(51, 65, 85, 0.95); color: #fff; padding: 10px 14px; border-radius: 10px; box-shadow: 0 8px 24px rgba(0,0,0,0.2); transform: translateY(10px); opacity: 0; animation: toastIn .25s ease forwards; }
        @keyframes toastIn { to { transform: translateY(0); opacity: 1; } }

        /* Back-to-top */
        #backToTop { position: fixed; right: 18px; bottom: 84px; width: 44px; height: 44px; border-radius: 50%; border: none; background: linear-gradient(135deg, #667eea, #764ba2); color: #fff; box-shadow: 0 8px 18px rgba(0,0,0,.2); cursor: pointer; display: none; align-items: center; justify-content: center; z-index: 2500; }
        #backToTop.show { display: flex; }

        /* Dark mode (override) */
        .dark-mode body, .dark-mode { background: #0f172a; color: #e5e7eb; }
        .dark-mode .navbar { background: rgba(15,23,42,0.95) !important; }
        .dark-mode .booking-card, .dark-mode .modal-content, .dark-mode .tip-card, .dark-mode .overview-card { background: #111827; border-color: #1f2937; color: #e5e7eb; }
        .dark-mode .provider-row { border-color: #1f2937; }
        .dark-mode .open-link { background: #0b1220; border-color: #1f2937; color: #93c5fd; }
        .dark-mode .open-link:hover { background: #2563eb; color: #fff; }
        .dark-mode .best-badge { background: #064e3b; color: #34d399; }
        .dark-mode .booking-dot { background: #374151; }
        .dark-mode .booking-dot.active { background: #60a5fa; }

        /* 分頁指示點 */
        .booking-dots {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin: 6px 0 14px;
        }
        .booking-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #e5e7eb;
            cursor: pointer;
            transition: transform 0.2s ease, background 0.2s ease;
        }
        .booking-dot:hover { transform: scale(1.15); }
        .booking-dot.active { background: #667eea; }

        /* 地圖導航 */
        .maps-wrapper { display: grid; gap: 18px; }
        .maps-form { background: #fff; border: 1px solid #eef0f3; border-radius: 16px; padding: 16px; box-shadow: 0 6px 18px rgba(0,0,0,.05); }
        .maps-form .row { display: grid; grid-template-columns: 1fr auto; gap: 10px; align-items: center; margin-bottom: 10px; }
        .maps-form input { width: 100%; border: 2px solid #e9ecef; border-radius: 12px; padding: 12px 14px; font-size: 1rem; }
        .maps-form .btn-group { display: flex; gap: 8px; }
        .maps-form .icon-btn { background: #f8f9fa; border: 1px solid #e9ecef; color: #667eea; border-radius: 10px; padding: 10px 12px; cursor: pointer; }
        .maps-form .icon-btn:hover { background: #667eea; color: #fff; }
        .mode-toggle { display: inline-flex; background: #f3f4f6; padding: 4px; border-radius: 999px; gap: 4px; }
        .mode-toggle button { border: none; background: transparent; padding: 8px 12px; border-radius: 999px; cursor: pointer; color: #374151; }
        .mode-toggle button.active { background: #667eea; color: #fff; }
        .maps-actions { display: flex; gap: 10px; flex-wrap: wrap; }
        .maps-actions .btn-primary { display: inline-flex; align-items: center; gap: 8px; }
        .nearby-chip { background: #f8f9fa; border: 1px solid #e9ecef; color: #374151; padding: 8px 12px; border-radius: 999px; cursor: pointer; }
        .nearby-chip:hover { background: #e5e7eb; }
        .maps-grid { display: grid; gap: 14px; grid-template-columns: 1fr; }
        @media (min-width: 900px) { .maps-grid { grid-template-columns: 1.1fr 1fr; } }
        .place-card { background: #fff; border: 1px solid #eef0f3; border-radius: 14px; padding: 14px; box-shadow: 0 6px 18px rgba(0,0,0,.05); display: grid; gap: 10px; }
        .place-card .card-head { display: flex; align-items: center; justify-content: space-between; }
        .place-card .badge { font-size: 12px; padding: 2px 8px; border-radius: 999px; background: #eef2ff; color: #4f46e5; }
        .place-card .card-actions { display: flex; gap: 8px; flex-wrap: wrap; }
        .place-card .mini-btn { background: #f8f9fa; border: 1px solid #e9ecef; color: #667eea; border-radius: 10px; padding: 8px 10px; cursor: pointer; }
        .place-card .mini-btn:hover { background: #667eea; color: #fff; }
        .maps-list { display: grid; gap: 10px; }
        .maps-empty { text-align: center; color: #6b7280; padding: 16px; }
        .map-preview { width: 100%; height: 360px; border: 1px solid #eef0f3; border-radius: 14px; overflow: auto; background: #f8f9fa; resize: vertical; min-height: 240px; max-height: 720px; }
        .map-preview iframe { width: 100%; height: 100%; border: 0; }
        .map-controls { display: flex; align-items: center; gap: 8px; justify-content: flex-end; }
        .map-controls input[type="range"] { width: 160px; }
        .map-controls .mini-btn { padding: 6px 10px; }
        .map-preview.fullscreen { position: fixed; left: 16px; right: 16px; top: 70px; bottom: 16px; height: auto; z-index: 4500; box-shadow: 0 20px 40px rgba(0,0,0,.25); border-radius: 12px; }
        .dark-mode .maps-form, .dark-mode .place-card { background: #111827; border-color: #1f2937; color: #e5e7eb; }
        .dark-mode .maps-form input { background: #0b1220; border-color: #1f2937; color: #e5e7eb; }
        .dark-mode .nearby-chip { background: #0b1220; border-color: #1f2937; color: #cbd5e1; }

        /* 全站 UX 強化 */
        .navbar { position: sticky; top: 0; z-index: 3000; backdrop-filter: blur(6px); -webkit-backdrop-filter: blur(6px); }
        body { scroll-behavior: smooth; }
        .focus-ring:focus { outline: 3px solid rgba(102,126,234,0.5); outline-offset: 2px; }
        .icon-btn-sm { background: #f8f9fa; border: 1px solid #e9ecef; color: #667eea; padding: 6px 8px; border-radius: 8px; cursor: pointer; }
        .icon-btn-sm:hover { background: #667eea; color: #fff; }
        .time-slot .quick-actions { display: inline-flex; gap: 6px; margin-left: 8px; vertical-align: middle; }
        .time-slot .quick-actions .icon-btn-sm { transform: translateY(-2px); }
        .dark-mode .icon-btn-sm { background: #0b1220; border-color: #1f2937; color: #93c5fd; }
    </style>
</head>
<body>
    <!-- 導航欄 -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fas fa-plane"></i>
                <span>日本關西之旅</span>
            </div>
            <ul class="nav-menu">
                <li><a href="#overview" class="nav-link">行程概覽</a></li>
                <li><a href="#schedule" class="nav-link">每日行程</a></li>
                <li><a href="#bookings" class="nav-link">預定清單</a></li>
                <li><a href="#maps" class="nav-link">地圖導航</a></li>
                <li><a href="#tips" class="nav-link">實用提醒</a></li>
            </ul>
            <div class="nav-actions">
                <button class="search-btn" onclick="showSearchModal()">
                    <i class="fas fa-search"></i>
                </button>
                <button class="search-btn" id="darkModeToggle" title="暗黑模式" onclick="toggleDarkMode()">
                    <i class="fas fa-moon"></i>
                </button>
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </nav>

    <!-- 英雄區域 -->
    <header class="hero">
        <div class="hero-content">
            <h1>日本關西深度之旅</h1>
            <p>2025年9月30日 - 10月6日 | 7天6夜精彩行程</p>
            <div class="hero-stats">
                <div class="stat">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>3個城市</span>
                </div>
                <div class="stat">
                    <i class="fas fa-utensils"></i>
                    <span>15+美食</span>
                </div>
                <div class="stat">
                    <i class="fas fa-camera"></i>
                    <span>20+景點</span>
                </div>
            </div>
            <div class="hero-actions">
                <button class="btn-primary" onclick="showSearchModal()">
                    <i class="fas fa-search"></i>
                    搜尋景點詳情
                </button>
                <button class="btn-secondary" onclick="scrollToSection('schedule')">
                    <i class="fas fa-calendar"></i>
                    查看行程
                </button>
            </div>
        </div>
        <div class="hero-image">
            <div class="floating-card">
                <h3>行程進度</h3>
                <div class="progress-bar">
                    <div class="progress" style="width: 75%"></div>
                </div>
                <p>75% 已完成規劃</p>
            </div>
        </div>
    </header>

    <!-- 行程概覽 -->
    <section id="overview" class="section">
        <div class="container">
            <h2 class="section-title">📋 行程概覽</h2>
            <div class="overview-grid">
                <div class="overview-card">
                    <div class="card-icon">
                        <i class="fas fa-hotel"></i>
                    </div>
                    <h3>住宿安排</h3>
                    <p>OASIS NANIWA 酒店<br>5人入住，6晚住宿</p>
                    <span class="status completed">已確認</span>
                </div>
                <div class="overview-card">
                    <div class="card-icon">
                        <i class="fas fa-train"></i>
                    </div>
                    <h3>交通規劃</h3>
                    <p>IC卡（ICOCA）<br>Osaka Metro 一日券（部分日）</p>
                    <span class="status pending">待預定</span>
                </div>
                <div class="overview-card">
                    <div class="card-icon">
                        <i class="fas fa-ticket-alt"></i>
                    </div>
                    <h3>門票預定</h3>
                    <p>環球影城門票<br>嵐山小火車</p>
                    <span class="status pending">待預定</span>
                </div>
                <div class="overview-card">
                    <div class="card-icon">
                        <i class="fas fa-utensils"></i>
                    </div>
                    <h3>餐廳預定</h3>
                    <p>貴桑桑燒肉<br>其他特色餐廳</p>
                    <span class="status pending">待預定</span>
                </div>
            </div>
        </div>
    </section>

    <!-- 地圖導航 -->
    <section id="maps" class="section">
        <div class="container">
            <h2 class="section-title">🗺️ 地圖導航</h2>
            <div class="maps-wrapper">
                <div class="maps-form">
                    <div class="row">
                        <input id="mapsFrom" type="text" placeholder="出發地（可留空使用目前位置）">
                        <div class="btn-group">
                            <button class="icon-btn" id="useMyLocation" title="使用目前位置"><i class="fas fa-location-crosshairs"></i></button>
                            <button class="icon-btn" id="swapLocations" title="交換出發/目的地"><i class="fas fa-right-left"></i></button>
                        </div>
                    </div>
                    <div class="row">
                        <input id="mapsTo" type="text" placeholder="目的地（例如：心齋橋 / OASIS NANIWA）">
                        <div class="mode-toggle" role="tablist">
                            <button class="active" data-mode="driving" title="開車"><i class="fas fa-car"></i></button>
                            <button data-mode="transit" title="大眾運輸"><i class="fas fa-train-subway"></i></button>
                            <button data-mode="walking" title="步行"><i class="fas fa-person-walking"></i></button>
                        </div>
                    </div>
                    <div class="maps-actions">
                        <button class="btn-primary" id="openDirections"><i class="fas fa-route"></i> 開啟導航</button>
                        <button class="btn-secondary" id="openMapSearch"><i class="fas fa-magnifying-glass-location"></i> 地圖搜尋</button>
                        <div class="nearby-group">
                            <span class="nearby-chip" data-query="餐廳">附近餐廳</span>
                            <span class="nearby-chip" data-query="超市">附近超市</span>
                            <span class="nearby-chip" data-query="便利商店">便利商店</span>
                            <span class="nearby-chip" data-query="藥妝店">藥妝店</span>
                        </div>
                    </div>
                </div>

                <div class="maps-grid">
                    <div class="maps-list" id="favoritePlaces">
                        <div class="place-card">
                            <div class="card-head"><h4>OASIS NANIWA</h4><span class="badge">住宿</span></div>
                            <div class="card-actions">
                                <button class="mini-btn" onclick="fillTo('OASIS NANIWA')"><i class="fas fa-location-dot"></i> 設為目的地</button>
                                <button class="mini-btn" onclick="openGoogleMaps('OASIS NANIWA')"><i class="fas fa-map"></i> 開地圖</button>
                            </div>
                        </div>
                        <div class="place-card">
                            <div class="card-head"><h4>環球影城（USJ）</h4><span class="badge">景點</span></div>
                            <div class="card-actions">
                                <button class="mini-btn" onclick="fillTo('環球影城')"><i class="fas fa-location-dot"></i> 設為目的地</button>
                                <button class="mini-btn" onclick="openGoogleMaps('環球影城')"><i class="fas fa-map"></i> 開地圖</button>
                            </div>
                        </div>
                        <div class="place-card">
                            <div class="card-head"><h4>心齋橋</h4><span class="badge">逛街</span></div>
                            <div class="card-actions">
                                <button class="mini-btn" onclick="fillTo('心齋橋')"><i class="fas fa-location-dot"></i> 設為目的地</button>
                                <button class="mini-btn" onclick="openGoogleMaps('心齋橋')"><i class="fas fa-map"></i> 開地圖</button>
                            </div>
                        </div>
                        <div class="maps-empty">可在各行程卡片按「地圖導航」快速加入收藏</div>
                    </div>
                    <div class="place-card">
                        <h4>Google 地圖預覽</h4>
                        <div class="map-controls">
                            <label for="mapZoom" style="color:#6b7280">縮放</label>
                            <input id="mapZoom" type="range" min="10" max="20" step="1" value="14">
                            <button class="mini-btn" id="mapZoomOut">-</button>
                            <button class="mini-btn" id="mapZoomIn">+</button>
                            <button class="mini-btn" id="mapFullscreen">全螢幕</button>
                        </div>
                        <div class="map-preview" id="mapPreviewContainer">
                            <iframe id="mapPreview" loading="lazy" referrerpolicy="no-referrer-when-downgrade" src="https://www.google.com/maps?q=%E5%A4%A7%E9%98%AA%20%E6%97%A5%E6%9C%AC&output=embed"></iframe>
                        </div>
                    </div>
                    <div class="place-card">
                        <h4>快速貼上 PDF 地址 / 常用連結</h4>
                        <p style="color:#6b7280">將網址貼到下方欄位，加入後可一鍵「開啟」或「填入目的地」。</p>
                        <div class="card-actions" style="gap:8px; align-items:center; flex-wrap:wrap;">
                            <input id="quickLinkInput" class="focus-ring" type="text" placeholder="貼上或輸入網址，如 https://www.cafe-gram.com/hongkong/" style="flex:1; min-width:260px; border:2px solid #e9ecef; border-radius:10px; padding:10px 12px;">
                            <button class="mini-btn" id="addQuickLinkBtn"><i class="fas fa-plus"></i> 加入連結</button>
                            <button class="mini-btn" onclick="pasteToDestination()"><i class="fas fa-paste"></i> 貼上到目的地</button>
                        </div>
                        <div id="quickLinks" class="quick-links" style="display:flex; flex-wrap:wrap; gap:8px; margin-top:10px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- 每日行程 -->
    <section id="schedule" class="section">
        <div class="container">
            <h2 class="section-title">📅 每日行程</h2>
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-date">Day 1<br>9/30 (二)</div>
                    <div class="timeline-content">
                        <h3>抵達關西 - 梅田</h3>
                        <div class="schedule-details">
                            <div class="time-slot">
                                <span class="time">10:25</span>
                                <span class="activity">抵達關西機場</span>
                                <button class="detail-btn" onclick="showLocationDetail('關西機場', 'airport', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                                <span class="quick-actions">
                                    <button class="icon-btn-sm" onclick="fillTo('關西機場')" title="設為目的地"><i class="fas fa-location-dot"></i></button>
                                    <button class="icon-btn-sm" onclick="addToFavorites('關西機場')" title="加入收藏"><i class="fas fa-heart"></i></button>
                                </span>
                            </div>
                            <div class="time-slot">
                                <span class="time">11:30</span>
                                <span class="activity">出關 → 搭乘南海特急 關西機場→新今宮（約¥1,500）</span>
                            </div>
                            <div class="time-slot">
                                <span class="time">13:00</span>
                                <span class="activity">抵達新今宮 → 寄放行李（約¥800）</span>
                            </div>
                            <div class="time-slot">
                                <span class="time">15:30</span>
                                <span class="activity">大丸梅田店寶可夢任天堂</span>
                                <button class="detail-btn" onclick="showLocationDetail('大丸梅田店寶可夢任天堂', 'shopping', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">16:30</span>
                                <span class="activity">道頓堀／美國村／天王寺公園（通天閣）擇一</span>
                                <button class="detail-btn" onclick="showLocationDetail('通天閣', 'attraction', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">18:00</span>
                                <span class="activity">大阪梅田貴桑桑燒肉</span>
                                <span class="note">7月預定，步行約7-10分鐘</span>
                                <button class="detail-btn" onclick="showLocationDetail('貴桑桑燒肉', 'restaurant', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                                <span class="quick-actions">
                                    <button class="icon-btn-sm" onclick="fillTo('貴桑桑燒肉')" title="設為目的地"><i class="fas fa-location-dot"></i></button>
                                    <button class="icon-btn-sm" onclick="addToFavorites('貴桑桑燒肉')" title="加入收藏"><i class="fas fa-heart"></i></button>
                                </span>
                            </div>
                            <div class="time-slot">
                                <span class="time">20:00</span>
                                <span class="activity">梅田天空嚇死人大樓</span>
                                <span class="note">從大阪站中央北口步行約7分鐘</span>
                                <button class="detail-btn" onclick="showLocationDetail('梅田天空大樓', 'attraction', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">22:00</span>
                                <span class="activity">通天閣滑梯（備選，視體力）</span>
                                <button class="detail-btn" onclick="showLocationDetail('通天閣', 'attraction', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-date">Day 2<br>10/1 (三)</div>
                    <div class="timeline-content">
                        <h3>環球影城 + 通天閣</h3>
                        <div class="schedule-details">
                            <div class="time-slot">
                                <span class="time">09:00</span>
                                <span class="activity">抵達環球影城</span>
                                <span class="transport">堺筋線天下茶屋→動物園前→大阪環狀線新今宮→西九條→JR夢咲線→環球城</span>
                                <button class="detail-btn" onclick="showLocationDetail('環球影城', 'attraction', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                                <span class="quick-actions">
                                    <button class="icon-btn-sm" onclick="fillTo('環球影城')" title="設為目的地"><i class="fas fa-location-dot"></i></button>
                                    <button class="icon-btn-sm" onclick="addToFavorites('環球影城')" title="加入收藏"><i class="fas fa-heart"></i></button>
                                </span>
                            </div>
                            <div class="time-slot">
                                <span class="time">19:00</span>
                                <span class="activity">離開環球影城</span>
                                <span class="important">記得退稅！</span>
                            </div>
                            <div class="time-slot">
                                <span class="time">19:30</span>
                                <span class="activity">烏龍麵棒大阪店</span>
                                <span class="backup">備案：大阪燒 (開到21:00)</span>
                                <button class="detail-btn" onclick="showLocationDetail('烏龍麵棒大阪店', 'restaurant', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">21:00</span>
                                <span class="activity">心齋橋逛街</span>
                                <button class="detail-btn" onclick="showLocationDetail('心齋橋', 'shopping', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-date">Day 3<br>10/2 (四)</div>
                    <div class="timeline-content">
                        <h3>京都一日遊</h3>
                        <div class="schedule-details">
                            <div class="time-slot">
                                <span class="time">07:30</span>
                                <span class="activity">起床前往稻荷神社</span>
                            </div>
                            <div class="time-slot">
                                <span class="time">08:30</span>
                                <span class="activity">伏見稻荷大社</span>
                                <button class="detail-btn" onclick="showLocationDetail('伏見稻荷大社', 'attraction', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">11:00</span>
                                <span class="activity">京都車站內 天婦羅（午餐）</span>
                                <button class="detail-btn" onclick="showLocationDetail('京都車站', 'attraction', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">12:00</span>
                                <span class="activity">清水寺</span>
                                <button class="detail-btn" onclick="showLocationDetail('清水寺', 'attraction', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">13:30</span>
                                <span class="activity">錦市場</span>
                                <span class="important">現金需要</span>
                                <span class="transport">清水寺→祇園四条站→阪急烏丸站→步行5分鐘</span>
                                <button class="detail-btn" onclick="showLocationDetail('錦市場', 'shopping', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">18:00</span>
                                <span class="activity">晚餐：京都鐵板燒 / Tsurukame Hon Ten（河原町）</span>
                                <button class="detail-btn" onclick="showLocationDetail('京都鐵板燒', 'restaurant', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-date">Day 4<br>10/3 (五)</div>
                    <div class="timeline-content">
                        <h3>嵐山竹林</h3>
                        <div class="schedule-details">
                            <div class="time-slot">
                                <span class="time">09:00</span>
                                <span class="activity">出發前往嵐山</span>
                                <span class="transport">JR：新今宮→（大阪/天王寺 轉乘）→ 嵯峨嵐山站；或 阪急：梅田→嵐山（步行至竹林）</span>
                            </div>
                            <div class="time-slot">
                                <span class="time">10:35</span>
                                <span class="activity">竹林小徑、野宮神社</span>
                                <span class="important">要搭小火車需預約 (嵯峨野トロッコ列車)</span>
                                <button class="detail-btn" onclick="showLocationDetail('嵐山竹林小徑', 'attraction', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                                <span class="quick-actions">
                                    <button class="icon-btn-sm" onclick="fillTo('嵐山竹林小徑')" title="設為目的地"><i class="fas fa-location-dot"></i></button>
                                    <button class="icon-btn-sm" onclick="addToFavorites('嵐山竹林小徑')" title="加入收藏"><i class="fas fa-heart"></i></button>
                                </span>
                            </div>
                            <div class="time-slot">
                                <span class="time">11:30</span>
                                <span class="activity">嵯峨野トロッコ列車（預約）</span>
                                <button class="detail-btn" onclick="showLocationDetail('嵯峨野トロッコ列車', 'attraction', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">12:30</span>
                                <span class="activity">嵐山よしむら</span>
                                <button class="detail-btn" onclick="showLocationDetail('嵐山よしむら', 'restaurant', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                                <span class="quick-actions">
                                    <button class="icon-btn-sm" onclick="fillTo('嵐山よしむら')" title="設為目的地"><i class="fas fa-location-dot"></i></button>
                                    <button class="icon-btn-sm" onclick="addToFavorites('嵐山よしむら')" title="加入收藏"><i class="fas fa-heart"></i></button>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-date">Day 5<br>10/4 (六)</div>
                    <div class="timeline-content">
                        <h3>宇治抹茶之旅</h3>
                        <div class="schedule-details">
                            <div class="time-slot">
                                <span class="time">09:00</span>
                                <span class="activity">平等院鳳凰堂參觀</span>
                                <span class="note">世界遺產，光線最佳、人潮最少</span>
                                <button class="detail-btn" onclick="showLocationDetail('平等院鳳凰堂', 'attraction', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">10:30</span>
                                <span class="activity">宇治商店街散策（宇治橋通商店街）</span>
                                <button class="detail-btn" onclick="showLocationDetail('宇治商店街', 'shopping', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">11:30</span>
                                <span class="activity">午餐自由選擇</span>
                                <span class="backup">中村藤吉、伊藤久右衛門、茶蕎麥麵</span>
                                <button class="detail-btn" onclick="showLocationDetail('中村藤吉', 'restaurant', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">13:00</span>
                                <span class="activity">通圓茶舖 or 伊藤久右衛門（甜點）</span>
                                <button class="detail-btn" onclick="showLocationDetail('通圓茶舖', 'restaurant', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">14:30</span>
                                <span class="activity">宇治神社、宇治上神社 參拜</span>
                                <button class="detail-btn" onclick="showLocationDetail('宇治神社', 'attraction', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">15:30</span>
                                <span class="activity">宇治川散策（黃昏風景最佳）</span>
                                <button class="detail-btn" onclick="showLocationDetail('宇治川', 'attraction', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">17:30</span>
                                <span class="activity">返回大阪（JR宇治→京都→大阪→新今宮）</span>
                            </div>
                            <div class="time-slot">
                                <span class="time">19:30</span>
                                <span class="activity">晚餐：元祖串かつ だるま 新世界總本店（二度付け禁止）</span>
                                <button class="detail-btn" onclick="showLocationDetail('元祖串かつ だるま 新世界総本店', 'restaurant', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-date">Day 6<br>10/5 (日)</div>
                    <div class="timeline-content">
                        <h3>大阪城 + 黑門市場</h3>
                        <div class="schedule-details">
                            <div class="time-slot">
                                <span class="time">09:45</span>
                                <span class="activity">大阪城、小車車</span>
                                <span class="price">¥300/人，可坐一圈園區</span>
                                <button class="detail-btn" onclick="showLocationDetail('大阪城', 'attraction', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                                <span class="quick-actions">
                                    <button class="icon-btn-sm" onclick="fillTo('大阪城')" title="設為目的地"><i class="fas fa-location-dot"></i></button>
                                    <button class="icon-btn-sm" onclick="addToFavorites('大阪城')" title="加入收藏"><i class="fas fa-heart"></i></button>
                                </span>
                            </div>
                            <div class="time-slot">
                                <span class="time">12:00</span>
                                <span class="activity">黑門市場午餐 & 逛街</span>
                                <span class="transport">地鐵長堀鶴見綠地線至心齋橋站，步行10分鐘</span>
                                <button class="detail-btn" onclick="showLocationDetail('黑門市場', 'shopping', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">16:00</span>
                                <span class="activity">下午茶／甜點：Gram 厚鬆餅、嵐山茶屋（心齋橋／四ツ橋）</span>
                                <button class="detail-btn" onclick="showLocationDetail('Gram 厚鬆餅', 'restaurant', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">17:30</span>
                                <span class="activity">晚餐：しゃぶしゃぶ豚々（吃到飽壽喜燒）</span>
                                <button class="detail-btn" onclick="showLocationDetail('しゃぶしゃぶ豚々', 'restaurant', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">20:00</span>
                                <span class="activity">天王寺散步或通天閣夜景（備選）</span>
                                <button class="detail-btn" onclick="showLocationDetail('通天閣', 'attraction', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-date">Day 7<br>10/6 (一)</div>
                    <div class="timeline-content">
                        <h3>瘋狂購物日</h3>
                        <div class="schedule-details">
                            <div class="time-slot">
                                <span class="time">09:00</span>
                                <span class="activity">退房＆一樓免費寄放行李（AM 8:00 ~ PM 10:00）</span>
                            </div>
                            <div class="time-slot">
                                <span class="time">09:30</span>
                                <span class="activity">心齋橋筋／難波地下街／唐吉訶德／無印良品／GU／Loft 採購</span>
                                <button class="detail-btn" onclick="showLocationDetail('心齋橋', 'shopping', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">11:30</span>
                                <span class="activity">午餐：炸牛排</span>
                            </div>
                            <div class="time-slot">
                                <span class="time">13:00</span>
                                <span class="activity">回 OASIS NANIWA 取行李</span>
                            </div>
                            <div class="time-slot">
                                <span class="time">13:30</span>
                                <span class="activity">新今宮出發（JR大阪環狀線 → JR關空快速）</span>
                            </div>
                            <div class="time-slot">
                                <span class="time">14:30</span>
                                <span class="activity">臨空城RP Outlet</span>
                                <span class="note">可逛1.5小時，注意機場報到時間</span>
                                <button class="detail-btn" onclick="showLocationDetail('臨空城Outlet', 'shopping', this)">
                                    <i class="fas fa-info-circle"></i>
                                </button>
                            </div>
                            <div class="time-slot">
                                <span class="time">16:10</span>
                                <span class="activity">由 Outlet 步行至臨空城站 → 前往關西機場</span>
                            </div>
                            <div class="time-slot">
                                <span class="time">16:30</span>
                                <span class="activity">抵達關西機場（建議 17:50 前完成報到與托運）</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 預定清單 / 預約比價 -->
    <section id="bookings" class="section">
        <div class="container">
            <h2 class="section-title">🧾 預約比價</h2>
            <div class="booking-controls">
                <div class="fx-rate">
                    <label for="fxRateInput">匯率 JPY→TWD：</label>
                    <input id="fxRateInput" type="number" step="0.0001" min="0" value="0.22" />
                    <small>用於將日幣換算成台幣以比較價格</small>
                </div>
                <div class="booking-actions">
                    <button class="btn-primary" id="resetBookingPricesBtn"><i class="fas fa-rotate"></i> 清空已輸入價格</button>
                </div>
            </div>
            <div class="booking-carousel-controls">
                <button class="carousel-btn" id="bookingPrev" title="往左"><i class="fas fa-chevron-left"></i></button>
                <button class="carousel-btn" id="bookingNext" title="往右"><i class="fas fa-chevron-right"></i></button>
            </div>
            <div id="bookingList" class="booking-list"></div>
            <div id="bookingDots" class="booking-dots" aria-label="分頁指示點"></div>
        </div>
    </section>

    <!-- 實用提醒 -->
    <section id="tips" class="section">
        <div class="container">
            <h2 class="section-title">💡 實用提醒</h2>
            <div class="tips-grid">
                <div class="tip-card">
                    <div class="tip-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <h3>重要時間點</h3>
                    <ul>
                        <li>7月：預定貴桑桑燒肉</li>
                        <li>提前3-6個月：預定住宿</li>
                        <li>提前2-3個月：預定環球影城門票</li>
                        <li>提前1個月：預定嵐山小火車</li>
                    </ul>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <h3>退稅提醒</h3>
                    <ul>
                        <li>環球影城購物記得退稅</li>
                        <li>藥妝店購物可退稅</li>
                        <li>百貨公司購物可退稅</li>
                        <li>記得帶護照</li>
                    </ul>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">
                        <i class="fas fa-suitcase"></i>
                    </div>
                    <h3>行李寄存</h3>
                    <ul>
                        <li>住宿一樓免費寄存</li>
                        <li>服務時間：AM 8:00 ~ PM 10:00</li>
                        <li>車站也有寄存服務</li>
                        <li>最後一天記得取行李</li>
                    </ul>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <h3>注意事項</h3>
                    <ul>
                        <li>錦市場需要現金</li>
                        <li>串かつ二度付け禁止</li>
                        <li>部分餐廳需要預定</li>
                        <li>注意機場報到時間</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- 搜尋模態框 -->
    <div id="searchModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>🔍 搜尋景點詳情</h2>
                <span class="close" onclick="closeSearchModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="輸入景點名稱..." onkeyup="searchLocations()">
                    <button onclick="searchLocations()">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
                <div class="search-results" id="searchResults">
                    <!-- 搜尋結果將在這裡顯示 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 景點詳情模態框 -->
    <div id="locationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="locationTitle">景點詳情</h2>
                <span class="close" onclick="closeLocationModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div id="locationContent">
                    <!-- 景點詳情將在這裡顯示 -->
                </div>
            </div>
        </div>
    </div>

    <button id="backToTop" title="回到頂部" onclick="window.scrollTo({top:0, behavior:'smooth'})"><i class="fas fa-arrow-up"></i></button>
    <div class="toast-container" id="toastContainer"></div>
    <script src="script_enhanced.js?v=4"></script>
</body>
</html>
